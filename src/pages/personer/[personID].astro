---
import Layout from "../../layouts/Layout.astro";
import { Debug } from "astro/components";
const { personID } = Astro.params;

const url = `https://pbhqptcgtunejfwsunzi.supabase.co/rest/v1/medlemmer`;

const options = {
  headers: {
    apikey:
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBiaHFwdGNndHVuZWpmd3N1bnppIiwicm9sZSI6ImFub24iLCJpYXQiOjE2Nzg1MjU3NjEsImV4cCI6MTk5NDEwMTc2MX0.qPLnnbV_2nDBjczEpGDt10lr3DQgCZ54roKiy0OZXL4",
  },
};

export async function getStaticPaths() {
  const url = `https://pbhqptcgtunejfwsunzi.supabase.co/rest/v1/medlemmer`;
  const options = {
    headers: {
      apikey:
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBiaHFwdGNndHVuZWpmd3N1bnppIiwicm9sZSI6ImFub24iLCJpYXQiOjE2Nzg1MjU3NjEsImV4cCI6MTk5NDEwMTc2MX0.qPLnnbV_2nDBjczEpGDt10lr3DQgCZ54roKiy0OZXL4",
    },
  };
  const response = await fetch(url, options);
  const data = await response.json();
  return data.map((person) => ({ params: { personID: person.id } }));
}

const urlOne = `https://pbhqptcgtunejfwsunzi.supabase.co/rest/v1/medlemmer?id=eq.${personID}`;

const res = await fetch(urlOne, options);
const dennePerson = await res.json();
---

<Debug {dennePerson} />

<Layout title={dennePerson.navn}>
  <article>
    <h2>{dennePerson.navn}</h2>
    <img src={`../thumbs/${dennePerson.billede}`} alt="profilbillede" />
  </article>
</Layout>
